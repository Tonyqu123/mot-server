<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../dependence/index.css">
  <title>MOT-CLOUD</title>
  <style>
    @font-face {
      font-family: element-icons;
      src: url('../dependence/fonts/element-icons.ttf'), url('../dependence/fonts/element-icons.woff');
    }
    #app, body, html{
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    .nav {
      width: 100%;
      height: 60px;
      background-color: rgb(44,111,166);
    }
    .head {
      width: 100%;
      height: 80px;
      background-color: rgb(84,163,232);
    }
    @keyframes rotating {
      0% {
          -webkit-transform: rotateZ(0);
          transform: rotateZ(0);
      }
      100% {
          -webkit-transform: rotateZ(360deg);
          transform: rotateZ(360deg);
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="nav" style="padding: 0 20%;">
      <div style="display: block;height: 100%;">
        <span style="font-size: 24px;line-height: 60px;color: azure;">MOT-CLOUD</span>
      </div>
    </div>
    <div class="head" style="padding: 0 20%;width: 60%;color: aliceblue;padding-top: 20px;">
      <div style="margin-bottom: 10px;">多目标跟踪平台</div>
      上传 MP4 格式文件，标注多目标跟踪结果。
    </div>
    <el-upload
      class="upload-demo"
      action="https://jsonplaceholder.typicode.com/posts/"
      :on-preview="handlePreview"
      :on-remove="handleRemove"
      :before-remove="beforeRemove"
      multiple
      :limit="3"
      :on-exceed="handleExceed"
      :file-list="fileList"
      :before-upload="beforeUpload"
      :on-success="handleSuccess"
      :on-error="handleError"
      style="width: 60%;margin: 0 auto;padding-top: 20px;">
      <el-button size="small" type="primary">上传文件</el-button>
    </el-upload>
    <el-table
      :data="tableData"
      className="mot-table"
      stripe
      v-loading="loading"
      style="width: 60%;margin: 0 auto;padding-top: 20px;">
      <el-table-column
        prop="id"
        label="文件ID"
        width="180">
      </el-table-column>
      <el-table-column
        prop="fileName"
        label="文件名">
      </el-table-column>
      <el-table-column
        prop="status"
        label="状态">
        <template slot-scope="scope">
          <template v-if="scope.row.status == 'transfering'">
            <img src="../icon/loading.svg" alt="" style="width: 18px; vertical-align: middle; animation: rotating 1s linear infinite;">
            <!-- {{scope.row.status}} -->
            视频跟踪中
          </template>
          <template v-if="scope.row.status == 'success'">
            <img src="../icon/success-filling.svg" alt="" style="width: 18px; vertical-align: middle;">
            <!-- {{scope.row.status}} -->
            视频跟踪成功
          </template>
        </template>
      </el-table-column>
      <el-table-column
        label="操作">
        <template slot-scope="scope">
          <el-button
            @click.native.prevent="downloadRow(scope.$index, tableData)"
            type="text"
            size="small">
            下载
          </el-button>
          <el-button
            @click.native.prevent="deleteRow(scope.$index, tableData)"
            type="text"
            size="small">
            移除
          </el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>
</body>
<script src="../dependence/vue.js"></script>
<script src="../dependence/index.js"></script>
<script>
  new Vue({
      el: '#app',
      data: function() {
        return {
          loading: false,
          fileList: [],
          tableData: []
        }
      },
      created: function () {
        let temp = []
        for (let index = 0; index < 30; index++) {
          temp.push({
            id: '2016-05-02',
            fileName: '上海市普陀区金沙江路 1518 弄',
            status: 'success' // transfering：跟踪中  / success：跟踪结束
          })
        }
        this.tableData = temp
      },
      methods: {
        deleteRow(index, rows) {
          rows.splice(index, 1);
          this.$message.success('删除成功！');
        },
        downloadRow(index, rows) {
          rows.splice(index, 1);
          this.$message.success('下载完成！');
        },
        handleRemove(file, fileList) {
          console.log(file, fileList);
        },
        handlePreview(file) {
          console.log(file);
        },
        handleExceed(files, fileList) {
          this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);
        },
        beforeRemove(file, fileList) {
          return this.$confirm(`确定移除 ${ file.name }？`);
        },
        handleSuccess(file, fileList) {
          console.log("success")
          this.loading = false
          this.$message({
            message: '文件上传成功！',
            type: 'success'
          });
        },
        handleError(file, fileList) {
          console.log("error")
          this.$message.error('文件上传失败！');
          this.loading = false
        },
        beforeUpload() {
          this.loading = true
        }
      }
    })
</script>
</html>